<!DOCTYPE html>
<html>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<body>
  <div id="tempChart" style="width:100%; max-width:600px; height:500px;"></div>

  <script type="text/javascript">

    // Load the Visualization API and the piechart package.
    google.charts.load('current', { 'packages': ['corechart'] });

    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {

      var jsonData = $.ajax({
        url: "../temperature.json",
        dataType: "json",
        async: false
        // success: function (data) {
        //console.log(data);
        //}
      }).responseJSON;

      var data = new google.visualization.DataTable();

      Object.entries(jsonData['temps']).forEach(function (jsonRowA, indexRow) {

        jsonRow = jsonRowA[1]

        // add columns
        if (indexRow === 0) {
          for (var column in jsonRow)
            switch (column) {
              case 'timestamp': data.addColumn('date', column); break;
              case 'air':
              case 'desc': break; //ignore
              case 'water': data.addColumn('number', column); break;
            }
        }


        // add row
        var dataRow = [];
        for (var column in jsonRow) {
          switch (column) {
            case 'timestamp': dataRow.push(new Date(jsonRow[column])); break;
            case 'air':
            case 'desc': break; //ignore
            case 'water': dataRow.push(parseFloat(jsonRow[column])); break;
          }
        }

        if (dataRow.length > 0) {
          data.addRow(dataRow);
        }
      });

      var options = {
          title: 'Water Temperature [Â°C] at The Wave',
          width: 2000,
          height: 800,
          hAxis: {
          // viewWindow: {
          //   min: new Date(2024, 4, 31, 18),
          //   max: new Date(2025, 0, 3, 1)
          // },
          // gridlines: {
          //   count: -1,
          //   units: {
          //     days: {format: ['MMM dd']},
          //     hours: {format: ['HH:mm', 'ha']},
          //   }
          // },
          // minorGridlines: {
          //   units: {
          //     hours: {format: ['hh:mm:ss a', 'ha']},
          //     minutes: {format: ['HH:mm a Z', ':mm']}
          //   }
          // }
        }
          // hAxis: {
          //   format: 'M/d/yy',
          //   gridlines: {count: 15}
          // }
          // ,
          // vAxis: {
          //   gridlines: {color: 'none'},
          //   minValue: 0
          // }
        };

      var chart = new google.visualization.LineChart(document.getElementById('tempChart'));
      chart.draw(data, options);
    }


  </script>

</body>

</html>